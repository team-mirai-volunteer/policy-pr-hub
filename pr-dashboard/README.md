# GitHub PR 可視化ダッシュボード（デモ版）

チームみらいのGitHub プルリクエストを可視化するダッシュボードです。

## 🎯 概要

PRの「スタンス（賛成/反対）」と「主張の強さ」を2次元プロットで可視化し、議論の傾向を一目で把握できます。

> ⚠️ **注意**: これはデモ版です。実用化にはモデルの改善と自動化が必要です。

## 🚀 使い方

### オンラインで見る
https://team-mirai.github.io/random/pr-dashboard/

### ローカルで動かす
1. このフォルダをダウンロード
2. `index.html`をブラウザで開く

## 📊 機能

- **散布図表示**: スタンス vs 主張強度の2次元プロット
- **ラベル別色分け**: 最大33種類のラベルを自動色分け
- **フィルタリング**:
  - ラベル別
  - カテゴリ別
  - 優先度別
  - キーワード検索
  - 重要フラグ
- **統計情報**: 基本統計、象限分析、フラグ別集計
- **インタラクティブ**: 
  - ホバーで詳細表示
  - クリックでGitHub PRへジャンプ

## 📋 データ形式

Excelファイル（pr_labels_flagged.xlsx）から以下の形式でJSONに変換：

```javascript
const PR_DATA = [
  {
    "stance_val": 3,        // スタンス値（-5〜5）
    "assert_val": 4,        // 主張強度（-5〜5）
    "label": "Enhancement", // ラベル
    "body": "本文...",      // PR本文
    "link": "https://...",  // PR URL
    "subject": "件名",      // 件名（オプション）
    "category": "カテゴリ", // カテゴリ（オプション）
    "priority": "High",     // 優先度（オプション）
    "flag_attention_high": false,  // 各種フラグ
    // ...
  }
];
```

## 🛠️ カスタマイズ

### データの更新方法

1. Pythonスクリプトで変換：
```python
python excel_to_json.py pr_labels_flagged.xlsx
```

2. 生成された`pr_data.js`を置き換え

### パフォーマンス調整

大量データの場合は初期表示を制限：
```javascript
// 最初の1000件のみ表示
filteredData = originalData.slice(0, 1000);
```

## 📄 ライセンス

チームみらいの内部利用を想定しています。

## 🤝 貢献

改善提案やバグ報告は[Issues](https://github.com/team-mirai/random/issues)まで。

## 🔧 技術詳細

### 現在の実装（デモ版）

このデモ版では以下のモデルを使用していますが、改善の余地があります：

- **要約処理**: `sonoisa/t5-base-japanese`
  - 現状: 性能が低く、要約の品質が不十分
  - 改善案: より高性能なLLM（GPT-4、Claude、Gemini等）への移行を推奨

- **スコア算出**: `sbintuitions/sarashina2.2-3b-instruct-v0.1`
  - スタンス値（-5〜5）と主張強度（-5〜5）の判定に使用
  - プロンプトエンジニアリングによる精度向上の余地あり

### 処理フロー

1. **要約フェーズ**
   - 長文PRコメントを80文字程度に要約
   - 重要キーワード（問題、課題、提案等）を優先的に抽出
   - 1000文字以上は自動的にトリミング

2. **スコア算出フェーズ**
   ```
   立場/スタンス（-5から+5）:
   -5: 強く反対・否定的
    0: 中立・どちらでもない
   +5: 強く賛成・肯定的
   
   主張の強さ（-5から+5）:
   -5: 非常に弱い・曖昧
    0: 普通
   +5: 非常に強い・断定的
   ```

3. **フラグ付与**
   - `flag_attention_high`: 要注意（|スタンス| ≥ 4 または 主張強度 ≥ 4）
   - `flag_strong_positive/negative`: 強い肯定/否定
   - `flag_extreme`: 極端な意見（|値| = 5）
   - `flag_review_needed`: レビュー必要
   - その他、20種類以上の詳細フラグ

4. **カテゴリ・優先度分類**
   - カテゴリ: 極端肯定/否定、強い肯定/否定、やや肯定/否定、中立
   - 優先度: High/Medium/Low/Minimal

詳細な実装は[処理スクリプト](process_script.py)を参照してください。

### 🚀 今後の展望

このダッシュボードは自由に改造・改善してください！以下のような自動化を期待しています：

1. **データ取得の自動化**
   - GitHub APIを使った定期的なPR情報の取得
   - 新規PR・コメントのリアルタイム反映

2. **分析の高度化**
   - より高性能なLLMの導入
   - 感情分析、トピック分類の追加
   - 時系列での議論の変化追跡

3. **運用の自動化**
   - GitHub Actionsによる定期更新
   - Slack/Discord通知連携
   - レポート自動生成

より実用的なツールに進化させてください！

## 🙏 謝辞

- Plotly.js: インタラクティブなグラフ描画
- 元のDashアプリケーション作成者
